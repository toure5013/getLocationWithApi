<script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>

<script>

if(location.protocol != 'https:') {
  if(window.chrome) {
    var position = {
      coords: {
        latitude: '',
        longitude: ''
      }
    };
$.getJSON(“http://ip-api.com/json", function (data, status) {
        if(status === "success") {
            if(data) {
                $.getJSON(“http://maps.googleapis.com/maps/api/geocode/json?address=" + res.zip, function (data, status) {
                    if (status === "success") {
                        position.coords.latitude = data.results[0].geometry.location.lat;
                        position.coords.longitude = data.results[0].geometry.location.lng;
                        locationOnSuccess(position);
                    } else {
                        locationOnError();
                    }
                });        
            } else {
                if(!data.zip && data.lat && data.lon) {
                //if there's not zip code but we have a latitude and longitude, let's use them
                position.coords.latitude = data.lat;
                position.coords.longitude = data.lon;
                locationOnSuccess(position);
                } else {
                    //if there's an error 
                    locationOnError();
                }
            }
        } else {
            locationOnError();
        }
    });
  } else {
      navigator.geolocation.getCurrentPosition(locationOnSuccess, locationOnError, geo_options);
  }
} else {
      navigator.geolocation.getCurrentPosition(locationOnSuccess, locationOnError, geo_options);
  }
  
</script>
  
